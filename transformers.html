<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Transformers & AC Power (A‑Level)</title>
<script src="https://cdn.tailwindcss.com"></script>
<meta name="color-scheme" content="dark light">
<style>
  .section{ border:1px solid rgba(255,255,255,.10); border-radius:1rem; background:rgba(255,255,255,.04); }
  .btn{ border:1px solid rgba(255,255,255,.12); padding:.5rem .8rem; border-radius:.6rem; }
  .btn:hover{ background:rgba(255,255,255,.08) }
  canvas{ image-rendering: crisp-edges; }
</style>
</head>
<body class="min-h-screen bg-slate-950 text-slate-100">
<header class="sticky top-0 z-40 border-b border-white/10 bg-slate-900/60 backdrop-blur">
  <div class="mx-auto max-w-7xl px-3 sm:px-6 py-3 flex items-center gap-3">
    <h1 class="text-lg sm:text-xl font-semibold">Transformers & AC Power</h1>
    <div class="ml-auto text-sm text-slate-300">Turns ratio • Load • Efficiency • Transmission</div>
  </div>
</header>

<main class="mx-auto max-w-7xl px-3 sm:px-6 py-5 grid gap-4 xl:grid-cols-[360px_1fr]">
  <aside class="section p-4 space-y-4">
    <div class="grid grid-cols-2 gap-3">
      <div>
        <label class="block text-xs uppercase tracking-wide text-slate-400 mb-1">Vₚ (rms, V)</label>
        <input id="Vp" type="range" min="1" max="500" step="1" value="230" class="w-full">
        <div class="text-xs text-slate-300">Vₚ = <span id="VpVal">230</span> V</div>
      </div>
      <div>
        <label class="block text-xs uppercase tracking-wide text-slate-400 mb-1">f (Hz)</label>
        <input id="f" type="range" min="10" max="1000" step="1" value="50" class="w-full">
        <div class="text-xs text-slate-300">f = <span id="fVal">50</span> Hz</div>
      </div>
    </div>
    <div class="grid grid-cols-2 gap-3">
      <div>
        <label class="block text-xs uppercase tracking-wide text-slate-400 mb-1">Turns Nₚ</label>
        <input id="Np" type="range" min="10" max="5000" step="10" value="1000" class="w-full">
        <div class="text-xs text-slate-300">Nₚ = <span id="NpVal">1000</span></div>
      </div>
      <div>
        <label class="block text-xs uppercase tracking-wide text-slate-400 mb-1">Turns Nₛ</label>
        <input id="Ns" type="range" min="10" max="5000" step="10" value="200" class="w-full">
        <div class="text-xs text-slate-300">Nₛ = <span id="NsVal">200</span></div>
      </div>
    </div>
    <div class="grid grid-cols-2 gap-3">
      <div>
        <label class="block text-xs uppercase tracking-wide text-slate-400 mb-1">Load R_L (Ω)</label>
        <input id="RL" type="range" min="1" max="1000" step="1" value="50" class="w-full">
        <div class="text-xs text-slate-300">R_L = <span id="RLVal">50</span> Ω</div>
      </div>
      <div>
        <label class="block text-xs uppercase tracking-wide text-slate-400 mb-1">Efficiency η (%)</label>
        <input id="eta" type="range" min="50" max="100" step="0.5" value="95" class="w-full">
        <div class="text-xs text-slate-300">η = <span id="etaVal">95.0</span>%</div>
      </div>
    </div>
    <div class="grid grid-cols-2 gap-3">
      <div>
        <label class="block text-xs uppercase tracking-wide text-slate-400 mb-1">Line R (Ω, two‑way)</label>
        <input id="Rline" type="range" min="0" max="100" step="0.5" value="10" class="w-full">
        <div class="text-xs text-slate-300">R_line = <span id="RlineVal">10.0</span> Ω</div>
      </div>
      <div class="flex items-end">
        <button id="swap" class="btn w-full">Swap step‑down / step‑up</button>
      </div>
    </div>

    <div class="text-xs text-slate-300 leading-6">
      Ideal: Vₛ/Vₚ = Nₛ/Nₚ, Iₛ/Iₚ = Nₚ/Nₛ. Real losses reduce efficiency η = P_out/P_in. Transmission losses scale with I²R — stepping up V reduces I for same power, cutting I²R.
    </div>
  </aside>

  <section class="grid gap-4">
    <div class="section p-3 grid gap-3">
      <canvas id="core" width="1000" height="260" class="w-full rounded-md bg-slate-900 border border-white/10"></canvas>
      <div class="grid md:grid-cols-2 gap-3">
        <div class="section p-3">
          <div class="text-slate-400 text-xs uppercase mb-1">Voltages & currents</div>
          <canvas id="bars" width="500" height="180" class="w-full rounded-md bg-slate-900 border border-white/10"></canvas>
        </div>
        <div class="section p-3">
<pre class="text-slate-200 text-xs leading-6 whitespace-pre-wrap">
Turns ratio a = Nₛ/Nₚ
  Vₛ = a Vₚ
  Iₛ = Vₛ / R_L
  P_out = Vₛ Iₛ
  P_in ≈ P_out / (η/100)
  Iₚ ≈ P_in / Vₚ
Transmission (series line resistance R_line):
  P_loss ≈ I_line² R_line (I_line ≈ Iₚ for step‑up on primary side or Iₛ on secondary side)
Raising V via step‑up reduces line current for a given power, minimizing I²R losses.
</pre>
        </div>
      </div>
      <div id="readouts" class="text-sm font-mono px-2"></div>
    </div>
  </section>
</main>

<script>
const Core = document.getElementById('core').getContext('2d');
const Bars = document.getElementById('bars').getContext('2d');
const out = document.getElementById('readouts');

const st = { Vp:230, f:50, Np:1000, Ns:200, RL:50, eta:95, Rline:10 };
const ids=s=>document.getElementById(s);
function sync(){
  ids('VpVal').textContent = st.Vp.toFixed(0);
  ids('fVal').textContent = st.f.toFixed(0);
  ids('NpVal').textContent = st.Np.toFixed(0);
  ids('NsVal').textContent = st.Ns.toFixed(0);
  ids('RLVal').textContent = st.RL.toFixed(0);
  ids('etaVal').textContent = st.eta.toFixed(1);
  ids('RlineVal').textContent = st.Rline.toFixed(1);
}
['Vp','f','Np','Ns','RL','eta','Rline'].forEach(id=> ids(id).addEventListener('input', e=>{
  st[id]=+e.target.value; sync(); drawAll();
}));
document.getElementById('swap').addEventListener('click', ()=>{
  const tmp = st.Np; st.Np = st.Ns; st.Ns = tmp; sync(); drawAll();
});

function calc(){
  const a = st.Ns/st.Np;
  const Vs = a*st.Vp;
  const Is = st.RL>0 ? Vs/st.RL : 0;
  const Pout = Vs*Is;
  const Pin = (st.eta>0? Pout/(st.eta/100) : Infinity);
  const Ip = st.Vp>0 ? Pin/st.Vp : 0;
  // assume line current on primary if step‑up, else on secondary (simple)
  const stepUp = a>1;
  const Iline = stepUp ? Ip : Is;
  const Ploss = Iline*Iline*st.Rline;
  return {a,Vs,Is,Pout,Pin,Ip,Iline,Ploss,stepUp};
}

function drawCore(){
  const W=Core.canvas.width, H=Core.canvas.height;
  Core.fillStyle="#0f172a"; Core.fillRect(0,0,W,H);
  // core
  Core.fillStyle="#475569"; Core.fillRect(W/2-120,40,240,H-80);
  Core.clearRect(W/2-90,70,180,H-140);
  // coils
  function coil(x, turns, col){
    Core.strokeStyle=col; Core.lineWidth=2;
    const n = Math.max(3, Math.min(14, Math.round(turns/200)));
    for (let i=0;i<n;i++){
      Core.beginPath();
      Core.ellipse(x, 90+i*12, 24, 8, 0, 0, Math.PI*2);
      Core.stroke();
    }
  }
  coil(W/2-140, st.Np, "#60a5fa");
  coil(W/2+140, st.Ns, "#34d399");
  // sine hints
  Core.strokeStyle="rgba(248,250,252,.4)"; Core.beginPath();
  for (let x=80;x<W-80;x++){
    const y = H-60 - Math.sin( (x-80)/60 )*20;
    if (x===80) Core.moveTo(x,y); else Core.lineTo(x,y);
  }
  Core.stroke();
  // labels
  Core.fillStyle="rgba(226,232,240,.9)"; Core.font="12px ui-sans-serif";
  Core.fillText("Primary (blue)", W/2-200, 24);
  Core.fillText("Secondary (green)", W/2+90, 24);
}

function drawBars(){
  const W=Bars.canvas.width, H=Bars.canvas.height;
  Bars.fillStyle="#0f172a"; Bars.fillRect(0,0,W,H);
  Bars.strokeStyle="rgba(148,163,184,.25)"; for (let y=0;y<H;y+=30){ Bars.beginPath(); Bars.moveTo(0,y); Bars.lineTo(W,y); Bars.stroke(); }
  const {Vs,Is,Pin,Pout,Ip,Iline,Ploss} = calc();
  const vals = [
    {label:"Vₚ", val:st.Vp}, {label:"Vₛ", val:Vs},
    {label:"Iₚ", val:Ip}, {label:"Iₛ", val:Is},
    {label:"P_in", val:Pin}, {label:"P_out", val:Pout},
    {label:"P_loss(line)", val:Ploss},
  ];
  const vmax = Math.max(...vals.map(v=>v.val||0), 1);
  const bw = (W-80)/vals.length;
  vals.forEach((v,i)=>{
    const h = (v.val/vmax)*(H-60);
    Bars.fillStyle="#60a5fa";
    if (v.label.includes("ₛ")) Bars.fillStyle="#34d399";
    if (v.label.includes("loss")) Bars.fillStyle="#f87171";
    Bars.fillRect(40+i*bw, (H-40)-h, bw*0.7, h);
    Bars.fillStyle="rgba(226,232,240,.9)"; Bars.font="12px ui-sans-serif";
    Bars.fillText(v.label, 40+i*bw+2, H-22);
  });
}

function drawReadouts(){
  const {a,Vs,Is,Pin,Pout,Ip,Iline,Ploss,stepUp} = calc();
  out.textContent = `a=Nₛ/Nₚ=${a.toFixed(3)}   Vₛ≈${Vs.toFixed(1)} V   Iₛ≈${Is.toFixed(2)} A   Iₚ≈${Ip.toFixed(2)} A   P_out≈${Pout.toFixed(1)} W   P_in≈${Pin.toFixed(1)} W   line current≈${Iline.toFixed(2)} A (${stepUp?"primary":"secondary"})   I²R loss≈${Ploss.toFixed(1)} W`;
}

function drawAll(){ drawCore(); drawBars(); drawReadouts(); }
sync(); drawAll();
</script>
</body>
</html>